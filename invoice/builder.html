<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Invoice Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  </head>
  <body class="min-h-screen flex flex-col items-center justify-center p-4">
    <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <div
          class="w-8 h-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center"
        >
          <span class="text-white font-bold text-sm">TIB</span>
        </div>
        <a href="/index.html" class="text-xl font-bold text-gray-900"
          >The Invoice Builder</a
        >
      </div>
      <!-- <a
          href="#how-it-works"
          class="text-gray-600 hover:text-gray-900 transition-colors"
          >How it Works</a
        >
        <a
          href="/invoice/builder.html"
          class="border border-blue-200 text-blue-700 hover:bg-blue-50 px-4 py-2 rounded-md transition-colors"
        >
          Get Started
        </a> -->
      <!-- Mobile menu button (optional, not implemented for brevity based on provided example) -->
    </nav>
    <div class="w-full max-w-7xl bg-white rounded-xl shadow-2xl p-8 space-y-6">
      <h1
        class="text-6xl gradient-text font-extrabold text-center text-purple-800 mb-6 tracking-tight"
      >
        Excel to Invoice PDFs
      </h1>
      <!-- Sample Excel Template Download Link -->
      <div
        class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-6 border border-green-200"
      >
        <div class="flex space-x-3 justify-between">
          <div class="flex space-x-3">
            <div
              class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center"
            >
              <svg
                class="w-6 h-6 text-green-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                />
              </svg>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Get Started</h3>
              <p class="text-gray-600">
                Download our sample Excel template to see the required format
              </p>
            </div>
          </div>
          <button
            id="downloadTemplate"
            class="ml-auto px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition-all duration-200 shadow-lg hover:shadow-xl"
          >
            Download Template
          </button>
        </div>
      </div>
      <!-- Sender Information Form -->
      <form id="senderForm" class="space-y-4">
        <label
          for="yourName"
          class="block text-gray-700 font-medium text-lg mb-2"
          ><b>Your Information:</b></label
        >
        <input
          type="text"
          id="yourName"
          placeholder="Your Name"
          class="w-full border rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent transition-all duration-200"
        />
        <input
          type="text"
          id="yourAddress"
          placeholder="Your Address"
          class="w-full border rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent transition-all duration-200"
        />
        <input
          type="text"
          id="yourTax"
          placeholder="Your Tax Number"
          class="w-full border rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent transition-all duration-200"
        />
        <!-- <label class="block text-gray-700 font-medium mt-4 text-lg"
          ><b>Company Logo</b> [Optional]</label
        >
        <input
          type="file"
          id="logoInput"
          accept="image/*"
          class="block w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-100 file:text-purple-700 hover:file:bg-purple-200 cursor-pointer transition-colors duration-200"
        /> -->
      </form>

      <!-- Drag & Drop Zone for Excel File -->
      <div
        id="dropZone"
        class="drop-zone border-4 border-dashed border-purple-400 rounded-xl p-12 text-center bg-purple-50 hover:bg-purple-100 cursor-pointer flex flex-col items-center justify-center min-h-[220px] shadow-lg"
      >
        <p class="text-3xl text-purple-700 font-bold mb-3">
          Drag & Drop your Excel file here
        </p>
        <p class="text-lg text-gray-600">or click to browse (.xlsx, .xls)</p>
        <input type="file" id="fileInput" accept=".xlsx, .xls" class="hidden" />
        <p id="fileName" class="mt-4 text-lg text-green-700 font-semibold"></p>
      </div>

      <!-- Generate Invoices Button -->
      <button
        id="generateInvoicesButton"
        class="mt-6 px-6 py-3 btn btn-primary w-full md:w-auto"
        disabled
      >
        Generate Invoices
      </button>

      <!-- Loading Message -->
      <div
        id="loadingMessage"
        class="hidden flex items-center justify-center p-4 text-lg text-purple-700 bg-purple-50 rounded-lg shadow-inner"
      >
        <div
          class="loading-spinner w-8 h-8 border-4 border-dotted rounded-full mr-3"
        ></div>
        Processing file and generating PDFs...
      </div>

      <!-- PDF Links and Download All Button -->
      <div
        id="pdfLinks"
        class="hidden mt-6 p-6 bg-green-50 border border-green-300 rounded-xl shadow-md"
      >
        <h2 class="text-xl font-semibold text-green-700 mb-4">
          Generated PDFs:
        </h2>
        <ul
          id="pdfList"
          class="list-disc list-inside text-gray-700 space-y-2"
        ></ul>
        <button
          id="downloadZip"
          class="mt-6 px-6 py-3 btn btn-primary w-full md:w-auto"
        >
          Download All as ZIP
        </button>
      </div>
    </div>

    <!-- Custom Modal for Alerts -->
    <div id="myModal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <p id="modalMessage" class="text-lg text-gray-800"></p>
        <button
          id="modalCloseBtn"
          class="mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg shadow btn-primary"
        >
          OK
        </button>
      </div>
    </div>
    <script src="script.js"></script>
  </body>
</html>
